cmake_minimum_required(VERSION 3.16)

project(SamosborGameDnD VERSION 0.1 LANGUAGES CXX)

set(CMAKE_AUTOUIC ON)
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# –ü–æ–∏—Å–∫ Qt
find_package(QT NAMES Qt6 Qt5 REQUIRED COMPONENTS Widgets)
find_package(Qt${QT_VERSION_MAJOR} REQUIRED COMPONENTS Widgets)

# üîπ –£–∫–∞–∑—ã–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
set(PROJECT_SOURCES
    main.cpp
    mainwindow.cpp mainwindow.h mainwindow.ui
    gamemodewindow.cpp gamemodewindow.h gamemodewindow.ui
    playermodewindow.cpp playermodewindow.h playermodewindow.ui
    createcharacterwindow.cpp createcharacterwindow.h createcharacterwindow.ui
    selectcharacterwindow.cpp selectcharacterwindow.h selectcharacterwindow.ui
    mastercontrolwindow.cpp mastercontrolwindow.h mastercontrolwindow.ui
    samosborcontroller.cpp samosborcontroller.h
    terminalprinter.cpp terminalprinter.h
    eventgenerator.cpp eventgenerator.h
    battlecontroller.cpp battlecontroller.h
    initiativetracker.cpp initiativetracker.h
    successcalculator.cpp successcalculator.h
    character_traits.cpp character_traits.h
    character_classes.cpp character_classes.h
    character_skills.cpp character_skills.h
)

# üîπ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
if(${QT_VERSION_MAJOR} GREATER_EQUAL 6)
    qt_add_executable(SamosborGameDnD
        MANUAL_FINALIZATION
        ${PROJECT_SOURCES}
        talenttreewidget.h talenttreewidget.cpp
        talentlogic.h talentlogic.cpp
        talenttreewidget.h talenttreewidget.cpp talenttreewidget.ui
        style.h
        resource.qrc
    )
else()
    if(ANDROID)
        add_library(SamosborGameDnD SHARED ${PROJECT_SOURCES})
    else()
        add_executable(SamosborGameDnD ${PROJECT_SOURCES})
    endif()
endif()

# üîπ –õ–∏–Ω–∫–æ–≤–∫–∞ —Å Qt
target_link_libraries(SamosborGameDnD PRIVATE Qt${QT_VERSION_MAJOR}::Widgets Qt${QT_VERSION_MAJOR}::Core)

# üîπ –°–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è Windows/Mac
set_target_properties(SamosborGameDnD PROPERTIES
    MACOSX_BUNDLE TRUE
    WIN32_EXECUTABLE TRUE
)

# üîπ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
include(GNUInstallDirs)
install(TARGETS SamosborGameDnD
    BUNDLE DESTINATION .
    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
)

# üîπ –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è Qt6
if(QT_VERSION_MAJOR EQUAL 6)
    qt_finalize_executable(SamosborGameDnD)
endif()
